---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# LRTesteR Overview
<!-- badges: start -->
[![R build status](https://github.com/gmcmacran/LRTesteR/workflows/R-CMD-check/badge.svg)](https://github.com/gmcmacran/LRTesteR/actions)
[![CRAN status](https://www.r-pkg.org/badges/version/LRTesteR)](https://cran.r-project.org/package=LRTesteR)
<!-- badges: end -->

LRTesteR provides likelihood ratio tests and associated confidence intervals for many common distributions. All functions match popular tests in R. If you are familiar with t.test and binom.test, you already know how to use these functions. Estimated asymptotic type I and type II error rates can be found [here](https://github.com/gmcmacran/TypeOneTypeTwoSim).

# Nonparametric Tests and Confidence Intervals

* Empirical Likelihood
  + mean
  + quantile
  
# Parametric Tests and Confidence Intervals

All parametric tests and confidence intervals rely on the $\chi^2$ approximation even when exact sampling distributions are known. Parametric tests require a sample size of at least 50. 

* Beta
  + shape 1
  + shape 2

* Binomial
  + p
  
* Exponential
  + rate
  
* Gamma
  + rate
  + scale
  + shape
  
* Gaussian
  + mu
  + variance
  
* Negative Binomial
  + p
  
* Poisson
  + lambda

* Cauchy
  + location
  + scale
  
* Inverse Gaussian
  + mean
  + shape
  + dispersion

# Example 1: Test lambda of a poisson distribution

To test lambda, simply call poisson_lambda_one_sample.

```{r example1Part1}
library(LRTesteR)

set.seed(1)
x <- rpois(n = 100, lambda = 1)
poisson_lambda_one_sample(x = x, lambda = 1, alternative = "two.sided")

```

# Example 2: Confidence Interval

To get a confidence interval, set the conf.level to the desired confidence. Below gets a two sided 90% confidence interval for scale from a Cauchy random variable.

```{r example2Part1}
set.seed(1)
x <- rcauchy(n = 100, location = 3, scale = 5)
cauchy_scale_one_sample(x = x, scale = 5, alternative = "two.sided", conf.level = .90)
```

Setting alternative to "less" gets a lower one sided interval. 
```{r example2Part2}
cauchy_scale_one_sample(x = x, scale = 5, alternative = "less", conf.level = .90)
```


Setting it to "greater" gets an upper one sided interval.
```{r example2Part3}
cauchy_scale_one_sample(x = x, scale = 5, alternative = "greater", conf.level = .90)
```

# Example 3: One-way Analysis
One-way ANOVA is generalized to all distributions. Here gamma random variables are created with different shapes. The one way test has a small p value and provides confidence intervals with 95% confidence for the whole set.

```{r example3Part1}
set.seed(1)
x <- c(rgamma(n = 50, shape = 1, rate = 2), rgamma(n = 50, shape = 2, rate = 2), rgamma(n = 50, shape = 3, rate = 2))
fctr <- c(rep(1, 50), rep(2, 50), rep(3, 50))
fctr <- factor(fctr, levels = c("1", "2", "3"))
gamma_shape_one_way(x = x, fctr = fctr, conf.level = .95)
```
# Example 4: Empirical Likelihood
The empirical likelihood tests do not require any distributional assumptions and work with less data.

```{r example4Part1}
set.seed(1)
x <- rnorm(n = 25, mean = 1, sd = 1)
empirical_mu_one_sample(x = x, mu = 1, alternative = "two.sided")
```

# The $\chi^2$ approximation

As implemented, all functions depend on the $\chi^2$ approximation. To get a sense of performance, lets compare the likelihood method to the exact method. Here, X is normally distributed with mu equal to 3 and standard deviation equal to 2. The two intervals are similar.

```{r MDPart1}
set.seed(1)
x <- rnorm(n = 50, mean = 3, sd = 2)
exactTest <- t.test(x = x, mu = 2.5, alternative = "two.sided", conf.level = .95)
likelihoodTest <- gaussian_mu_one_sample(x = x, mu = 2.5, alternative = "two.sided", conf.level = .95)
as.numeric(exactTest$conf.int)
likelihoodTest$conf.int
```

Lets compare tests for variance. Again, confidence intervals are similar.
```{r MDPart2}
sigma2 <- 1.5^2 # Variance, not standard deviation.
exactTest <- EnvStats::varTest(x = x, sigma.squared = sigma2,  alternative = "two.sided", conf.level = .95)
likelihoodTest <- gaussian_variance_one_sample(x = x, sigma.squared = sigma2, alternative = "two.sided", conf.level = .95)
as.numeric(exactTest$conf.int)
likelihoodTest$conf.int
```

Changing to p for a binomial distribution, the confidence intervals are similar yet again. 
```{r MDPart3}
exactTest <- stats::binom.test(x = 10, n = 50,  p = .50, alternative = "two.sided", conf.level = .95)
likelihoodTest <- binomial_p_one_sample(x = 10, n = 50,  p = .50, alternative = "two.sided", conf.level = .95)
as.numeric(exactTest$conf.int)
likelihoodTest$conf.int
```

When exact methods are known, use them. The utility of the likelihood based approach is its generality. Many tests in this package don't have other well known options.
